# Rock Climbing Calendar

Веб-приложение для небольшого climbing-комьюнити: календарь совместных тренировок по скалодромам + встроенный чат на той же странице.

## Что умеет

- Показывает месячный календарь и список ближайших посещений.
- Позволяет создавать/удалять записи на тренировки.
- Поддерживает «неуверенные» записи (формат «возможно пойду»).
- Отмечает дни с активностями и текущий день визуально в сетке календаря.
- Содержит чат с автообновлением и оптимистичной отправкой сообщений.
- Запоминает часть данных локально, чтобы интерфейс открывался быстрее.

## Продакшн

- GitHub Pages: <https://anyalink99.github.io/rockclimbingcalendar.github.io/>

## Технологии

- HTML + CSS + Vanilla JavaScript (без сборщика и фреймворков).
- dayjs (через CDN) для дат/времени.
- Google Apps Script как API-слой.
- Google Sheets как хранилище данных.

## Архитектура проекта

```text
.
├── index.html
├── styles/
│   └── main.css
├── scripts/
│   ├── app.js
│   ├── chat.js
│   ├── gyms.js
│   ├── common/
│   │   ├── core.js
│   │   ├── endpoints.js
│   │   ├── interaction-lock.js
│   │   └── optimistic.js
│   ├── calendar/
│   │   ├── config.js
│   │   ├── controller.js
│   │   ├── data.js
│   │   ├── render.js
│   │   └── ui.js
│   ├── chat/
│   │   ├── config.js
│   │   ├── controller.js
│   │   ├── data.js
│   │   └── view.js
│   └── gyms/
│       ├── data.js
│       └── pricing.js
└── backends/
    ├── backend.gs
    ├── backend_chat.gs
    └── backend_gyms.gs
```

## Бэкенды и данные

В проекте разделены зоны ответственности по данным:

- `backends/backend.gs` — операции календаря (записи на скалодромы).
- `backends/backend_chat.gs` — операции чата.
- `backends/backend_gyms.gs` — данные/логика, связанные со скалодромами.

Фронтенд обращается к endpoint-ам, заданным в `scripts/common/endpoints.js`.

## Ключевые UX/логические особенности

- **Optimistic UI** в календаре и чате: пользователь сразу видит результат действия, затем выполняется сверка с сервером.
- **Локальный кеш**: при старте используются сохранённые данные, после чего подтягивается свежий снимок.
- **Стабильность анимаций**: механики подавляют повторные анимации уже отрисованных элементов.
- **Адаптация под мобильную клавиатуру** в чате через `visualViewport`.
- **Темизация и единые CSS-переменные** для управления внешним видом.

## Локальный запуск

Так как это статический фронтенд, достаточно любого простого HTTP-сервера.

Пример:

```bash
python3 -m http.server 4173
```

Открыть в браузере:

- <http://localhost:4173>

## Как вносить изменения

1. Внести изменения в соответствующие модули (`scripts/calendar/*`, `scripts/chat/*`, `styles/main.css` и т.д.).
2. Проверить страницу локально.
3. Убедиться, что endpoint-ы для нужной среды корректно заданы в `scripts/common/endpoints.js`.
4. Закоммитить изменения с понятным сообщением.

## Планы по улучшению (опционально)

- Добавить unit-тесты для нормализации данных и reconciliation-логики.
- Выделить типы данных (через JSDoc/TypeScript) для контрактов API.
- Добавить небольшой e2e smoke-тест календаря и чата.
